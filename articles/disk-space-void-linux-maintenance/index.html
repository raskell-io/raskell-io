<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=theme-color content="dark">
<title>Disk space maintenance on Void Linux | Raskell</title>
<meta property="og:site_name" content="Raskell | Tech web space curated by Raffael">
<meta property="og:title" content="Disk space maintenance on Void Linux | Raskell">
<meta itemprop=name content="Disk space maintenance on Void Linux | Raskell">
<meta name=twitter:title content="Disk space maintenance on Void Linux | Raskell">
<meta name=application-name content="Disk space maintenance on Void Linux | Raskell"><meta name=twitter:card content="summary">
<meta name=description content="What to do when disk space is full after not paying attention after many months if not years of using Void Linux.">
<meta name=twitter:description content="What to do when disk space is full after not paying attention after many months if not years of using Void Linux. ">
<meta itemprop=description content=" What to do when disk space is full after not paying attention after many months if not years of using Void Linux. ">
<meta property="og:description" content=" What to do when disk space is full after not paying attention after many months if not years of using Void Linux. ">
<link rel="shortcut icon" type=image/x-icon href=/favicon.ico>
<link rel=stylesheet href=/sass/main.min.2557be7a7c0eec046bd9d68dfe050206dde68ad27849ca13f5e4c40ecf1aa24b.css>
</head>
<script>(function(){const a='ThemeColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='ThemeColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.userColorScheme='dark':document.documentElement.dataset.userColorScheme='light'})()</script>
<body class=dark>
<nav class=navbar>
<div class=container>
<div class=flex>
<div>
<a class=brand href=/>
<img src=/favicon.ico>
Raskell
</a>
</div>
<div class=flex>
<a href=/articles/>Articles</a>
<button id=dark-mode-button><svg class="light" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#343a40" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg class="dark" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fffd62" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</div>
</div>
</div>
</nav>
<main>
<div class=container>
<article>
<header class=article-header>
<div class=thumb>
<div>
<h1>Disk space maintenance on Void Linux</h1>
<div class=post-meta>
<div>
By Raffael | <time>24-05-01</time>
| 4 minutes
</div>
<div class=tags>
<a href=/tags/linux/>linux</a>
</div>
</div>
</div>
</div>
</header>
</article>
<div class=article-post>
<p><img loading=lazy src=/void-disk-usage.png alt=void-disk-usage.png width=928 height=289></p>
<h2 id=monday-morning-surprise>
<a href=#monday-morning-surprise class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>
</a>
Monday morning surprise
</h2>
<p>As I spent most time doing stuff with my computer rather than configuring my beloved Linux distribution, Void Linux, I have developed the tendency to not really bother about Void at all until something crucial becomes unusable. After almost two years of having switched from Arch to Void, I have actually never encountered any major problem and felt I had made the right decision.</p>
<p>I checked my disk usage out of curiosity if the 250GB solid-state disk would be enough. And there came the surprise:</p>
<pre tabindex=0><code>$ df -H
Filesystem      Size  Used Avail Use% Mounted on
devtmpfs        8.4G     0  8.4G   0% /dev
tmpfs           8.4G  1.9M  8.4G   1% /dev/shm
tmpfs           8.4G  1.4M  8.4G   1% /run
/dev/nvme0n1p3  138G  117G   21G  85% /
efivarfs        158k   85k   69k  56% /sys/firmware/efi/efivars
cgroup          8.4G     0  8.4G   0% /sys/fs/cgroup
/dev/nvme0n1p4  366G   34G  332G  10% /home
/dev/nvme0n1p1  536M  152k  536M   1% /boot/efi
tmpfs           8.4G   25k  8.4G   1% /tmp
</code></pre><p>My root partition was full, way too full in my opinion. Did I miss something? Is Void not what I was looking for after all? I don&rsquo;t enjoy baby sitting my OS <em>du jour</em>.</p>
<h2 id=the-painless-solution>
<a href=#the-painless-solution class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>
</a>
The painless solution
</h2>
<p>After a quick Brave search, I ended up finding what I was looking for. Some kind fellow software engineer from China didn&rsquo;t shy away to make a blog post about his journey when he faced the very same problem. Out of annoyance of having to deal with that, I copy-pasted as quickly as possible, not minding what kind of side-effects I might run into, these three commands.</p>
<h3 id=1-cleaning-the-package-cache>
<a href=#1-cleaning-the-package-cache class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>
</a>
1. Cleaning the package cache
</h3>
<p>All the knowledge I was lacking was to be found with the man page of <code>xbps-remove</code>.</p>
<pre tabindex=0><code># xbps-remove -yO
</code></pre><p>The <a href=https://man.voidlinux.org/xbps-remove.1#O,>man page</a> of <code>xbps-remove</code> tells us the <code>-O</code> parameter takes care of <em>cleaning the cache directory removing obsolete binary packages.</em> Obsolete binary packages? Good riddance! I was surprised this to learn that solely this step freed up almost half of my used root partition disk space.</p>
<h3 id=2-removing-orphaned-packages>
<a href=#2-removing-orphaned-packages class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>
</a>
2. Removing orphaned packages
</h3>
<pre tabindex=0><code># xbps-remove -yo
</code></pre><p>Here the same <a href=https://man.voidlinux.org/xbps-remove.1#o,>man page</a> tells us that the <code>-o</code> parameter takes care of <em>removing installed package orphans that were installed automatically (as dependencies) and are not currently dependencies of any installed package.</em> As before, good riddance!</p>
<h3 id=3-purging-old-unused-kernels>
<a href=#3-purging-old-unused-kernels class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>
</a>
3. Purging old, unused kernels
</h3>
<p>This one is interesting. While I knew about the circumstance that the people behind Void had developed their own package management ecosystem, I hadn&rsquo;t fully realized there were other utilities that came along with the upstream Void installation which were there for me to manage my beloved OS. So, apparently, one of these is a <a href=https://github.com/void-linux/void-packages/blob/master/srcpkgs/base-files/files/vkpurge>shell script</a> name <code>vkpurge</code>, I must assume as a short name for <code>Void's Kernel purging</code> tool. I like this type of naming heavily implying its functionality.</p>
<pre tabindex=0><code># vkpurge rm all
</code></pre><p>It performed as expected. Old kernel files (and modules?) were indeed purged and freed up even more disk space. I should add that this step is optional as it is always useful to have some old kernels at hand when things hit the fan (which for me, they haven&rsquo;t in a very, very long time).</p>
<h2 id=result>
<a href=#result class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>
</a>
Result
</h2>
<p>I couldn&rsquo;t be happier.</p>
<pre tabindex=0><code>$ df -H
Filesystem      Size  Used Avail Use% Mounted on
...
/dev/nvme0n1p3  138G   45G   93G  33% /
...
</code></pre><h2 id=renewal-of-faith>
<a href=#renewal-of-faith class=anchor><svg class="icon" aria-hidden="true" focusable="false" height="16" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5.0-3-1.69-3-3.5S2.55 3 4 3h4c1.45.0 3 1.69 3 3.5.0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98.0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98.0-2-1.22-2-2.5.0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45.0 3-1.69 3-3.5S14.5 6 13 6z"/></svg>
</a>
Renewal of faith
</h2>
<p>Overall, why am I even writing this if some other fellow engineer already figured this out? Simply, because I would therefore be able to explain why I have enjoyed my journey with Void as my go-to Linux distribution. It keeps things simple. Some well-documented utilities. As simple that a simple Brave search suffices to find the answer to my problems.</p>
<p>This very aspect of Void is worthwhile highlighing. I remember more arcane Linux distributions that had me in their grip in figuring things out. Many Googles searches were necessary and even more trial and errors attempts to get simple things fixed.</p>
<p>Now back to my Monday morning.</p>
<hr>
<p>[1]: Painting in header image is &ldquo;Seaside&rdquo; by Aleksandr Deyneka</p>
</div>
</div>
<div class=container>
<nav class="flex container suggested">
<a rel=prev href=/articles/all-beginning-is-haskell/ title="Previous post (older)">
<span>Previous</span>
All beginning is Haskell
</a>
</nav>
</div>
<div class=container>
</div>
</main>
</main>
<footer class="footer flex">
<section class=container>
<nav class=footer-links>
<a href=/index.xml>RSS</a>
</nav>
</section>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css integrity=sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc crossorigin=anonymous>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js integrity=sha384-YNHdsYkH6gMx9y3mRkmcJ2mFUjTd0qNQQvY9VYZgQd7DcN7env35GzlmFaZ23JGp crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload="renderMathInElement(document.querySelector('.article-post'),{delimiters:[{left:'$$',right:'$$',display:!0},{left:'$',right:'$',display:!1},{left:'\\(',right:'\\)',display:!1},{left:'\\[',right:'\\]',display:!0}]})"></script>
<script defer src=/ts/features.aeccc1b543daef772e7584f28d3bc3e21c62dfd259256c435908dbe148b24c6c.js data-enable-footnotes=true></script>
</footer>
</body>
</html>